<% slot_label = slot_label_for(slot_position) %>

<div class="group flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-move border border-gray-100"
     data-media-item-id="<%= media_item.id %>">

  <!-- Position Number -->
  <div class="flex-shrink-0 w-8 text-center">
    <span class="text-gray-400 font-mono text-sm"><%= slot_position %>.</span>
  </div>

  <!-- Drag Handle -->
  <div class="drag-handle flex-shrink-0 cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"/>
    </svg>
  </div>

  <!-- Cover Art -->
  <div class="flex-shrink-0">
    <% if media_item.release&.cover_image&.attached? %>
      <%= image_tag media_item.release.cover_image,
          class: "w-12 h-12 object-cover rounded shadow-sm" %>
    <% else %>
      <div class="w-12 h-12 bg-gray-200 rounded flex items-center justify-center shadow-sm">
        <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
          <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1" fill="none"/>
          <circle cx="10" cy="10" r="2" fill="currentColor"/>
        </svg>
      </div>
    <% end %>
  </div>

  <!-- Slot Label -->
  <div class="flex-shrink-0 w-12">
    <span class="inline-block px-2 py-1 bg-gray-100 text-gray-600 text-xs font-mono rounded" data-slot-label>
      <%= slot_label %>
    </span>
  </div>

  <!-- Album Title -->
  <div class="flex-1 min-w-0">
    <%= link_to media_item_path(media_item), class: "hover:text-blue-600" do %>
      <p class="font-semibold truncate" title="<%= media_item.display_title %>">
        <%= media_item.display_title || "Untitled" %>
      </p>
    <% end %>
  </div>

  <!-- Artist -->
  <div class="flex-shrink-0 w-48">
    <p class="text-gray-500 text-sm truncate" title="<%= media_item.release&.media_owner&.name %>">
      <%= media_item.release&.media_owner&.name || "Unknown Artist" %>
    </p>
  </div>

  <!-- Move to Top/Bottom/Insert Gap -->
  <div class="flex-shrink-0 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
    <%= button_to cd_collection_insert_gap_path(id: location.id, slot: slot_position),
        method: :post,
        class: "text-gray-400 hover:text-green-600 p-1 cursor-pointer",
        title: "Insert gap before" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
      </svg>
    <% end %>
    <%= link_to cd_collection_move_to_top_path(location_id: location.id, id: media_item.id),
        data: { turbo_method: :patch },
        class: "text-gray-400 hover:text-blue-600 p-1",
        title: "Move to top" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
      </svg>
    <% end %>
    <%= link_to cd_collection_move_to_bottom_path(location_id: location.id, id: media_item.id),
        data: { turbo_method: :patch },
        class: "text-gray-400 hover:text-blue-600 p-1",
        title: "Move to bottom" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
      </svg>
    <% end %>
  </div>
</div>
