<%# Hover details popup for media items - shows artist, title, year, and tracks by side %>
<div class="p-4 bg-white rounded-lg shadow-xl border border-gray-200 min-w-80 max-w-md">
  <!-- Artist -->
  <p class="font-medium text-gray-900 truncate" title="<%= media_item.media_owner&.name %>">
    <%= media_item.media_owner&.name || "Unknown Artist" %>
  </p>

  <!-- Album Title -->
  <p class="font-semibold text-lg truncate" title="<%= media_item.title %>">
    <%= media_item.title || "Untitled" %>
  </p>

  <!-- Year & Format -->
  <div class="flex gap-4 text-sm text-gray-500 mt-1">
    <span><%= display_year(media_item) %></span>
    <% if media_item.media_type&.name %>
      <span><%= media_item.media_type.name %></span>
    <% end %>
  </div>

  <!-- Genres -->
  <% if media_item.genres.any? %>
    <p class="text-sm text-gray-500 mt-1">
      <%= media_item.genres.map(&:name).join(", ") %>
    </p>
  <% end %>

  <!-- Tracks by Side -->
  <% if media_item.release_tracks.any? %>
    <div class="mt-3 pt-3 border-t border-gray-200">
      <% tracks_by_side = media_item.release_tracks.group_by { |t| t.position.match(/^([A-Z])/i)&.[](1)&.upcase || "?" } %>
      <div class="grid grid-cols-2 gap-4">
        <% tracks_by_side.each do |side, tracks| %>
          <div>
            <% if media_item.media_type == "Vinyl"%>
            <h4 class="font-semibold text-xs text-gray-700 mb-1">Side <%= side %></h4>
            <% end %>
            <ol class="list-none space-y-0.5">
              <% tracks.each.with_index(1) do |track, idx| %>
                <li class="text-xs text-gray-600 truncate" title="<%= track.name %>">
                  <span class="text-gray-400"><%= idx %>.</span> <%= track.name %>
                </li>
              <% end %>
            </ol>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
